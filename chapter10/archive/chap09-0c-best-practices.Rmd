---
output:
  pdf_document: default
  html_document: default
---
# Classifiers

### Best Practices

### Prioritization, Classification, and Storytelling

- Probability for ranking
- Classification 

#### Class Imbalance {-}



```{r, fig.height = 2.5, warning=FALSE, message=FALSE, echo = FALSE, fig.cap = "Classifying observations using a probability threshold."}

#Libs
  library(ggplot2)
  library(grid)
  library(gridExtra)

#Prep data for balanced
  set.seed(123)
  a <- rnorm(1000,0.3,0.12)
  
  set.seed(123)
  c <- rnorm(1000,0.7,0.12)
  sep.df <- data.frame(a = c(a,c), b = c(a,c))
  sep.df <- sep.df[sep.df$a <=1 & sep.df$a >=0,]
  
#Prep data for unbalanced 1 + 2
  set.seed(40)
  a <- rnorm(1800,0.03,0.015)
  
  set.seed(123)
  c <- rnorm(200,0.1,0.03)
  sep.ub <- data.frame(a = c(a,c), b = c(a,c))
  sep.ub <- sep.ub[sep.ub$a <=1 & sep.ub$a >=0,]

#Plot
  cutoff <- 0.5
  height <- max(c(density(sep.df$a[1:1000], na.rm=T)$y,density(sep.df$a[1001:2000], na.rm=T)$y))*1.1
  balanced <- ggplot() + 
            ggtitle("(1) Balanced - Cutoff: 0.5") + xlab("Probability")+
            geom_density(aes(sep.df$a[1:1000]), fill = "orange", alpha = 0.3)  +
            geom_density(aes(sep.df$a[1001:2000]), fill = "blue", alpha = 0.3)  +
            geom_vline(aes(xintercept = 0.5), linetype = "dashed") + 
            annotate(geom="text", x=0.7, y=height, label="(+)") + 
            annotate(geom="text", x=0.3, y=height, label="(-)")  +
            theme(plot.title = element_text(size = 10, hjust = 0.5), 
                  axis.line=element_blank(),
                  axis.text.y=element_blank(),
                  axis.ticks=element_blank(),
                  axis.title.x=element_blank(),
                  axis.title.y=element_blank(),
                  legend.position="none",
                  panel.background=element_blank(),
                  panel.border=element_blank(),
                  panel.grid.major=element_blank(),
                  panel.grid.minor=element_blank(),
                  plot.background=element_blank())

  
#Plot
  cutoff <- 0.06
  height <- max(c(density(sep.ub$a[1:1800], na.rm=T)$y,density(sep.ub$a[1801:2000], na.rm=T)$y))*1.1
  unbalanced <- ggplot() + 
            ggtitle("(2) Unbalanced - Variable Threshold") + xlim(c(0,1)) + 
            labs(x = "Probability")+
            geom_density(aes(sep.ub$a[1:1800]), fill = "orange", alpha = 0.3)  +
            geom_density(aes(sep.ub$a[1801:2000]), fill = "blue", alpha = 0.3)  +
            geom_vline(aes(xintercept = cutoff), linetype = "dashed") + 
            annotate(geom="text", x= cutoff*1.7, y=height, label="(+)") + 
            annotate(geom="text", x=cutoff*0.3, y=height, label="(-)")  +
            theme(plot.title = element_text(size = 10, hjust = 0.5), 
                  axis.line=element_blank(),
                  axis.text.y=element_blank(),
                  axis.ticks=element_blank(),
                  axis.title.x=element_blank(),
                  axis.title.y=element_blank(),
                  legend.position="none",
                  panel.background=element_blank(),
                  panel.border=element_blank(),
                  panel.grid.major=element_blank(),
                  panel.grid.minor=element_blank(),
                  plot.background=element_blank())
  
#Overlay
  grid.arrange(balanced, unbalanced, ncol = 2)
```
